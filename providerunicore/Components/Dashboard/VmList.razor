@using unicoreprovider.Models
@namespace unicoreprovider.Components

<style>
    .table-dark-override {
        --bs-table-bg: transparent !important;
        --bs-table-striped-bg: transparent !important;
        --bs-table-hover-bg: var(--uc-bg-elevated) !important;
        --bs-table-color: var(--uc-text-table) !important;
        --bs-table-border-color: var(--uc-border) !important;
        background-color: transparent !important;
        color: var(--uc-text-table) !important;
    }

    .table-dark-override th,
    .table-dark-override td {
        background-color: transparent !important;
        border-bottom: 1px solid var(--uc-border);
    }

    .vm-list-card {
        background-color: var(--uc-bg-card) !important;
        border: 1px solid var(--uc-border) !important;
        border-radius: var(--uc-radius) !important;
    }
</style>

<div class="card vm-list-card h-100 p-3">
    <div class="d-flex align-items-center mb-3">
        <h6 class="text-uppercase fw-bold mb-0" style="letter-spacing: 1px; font-size: 0.75rem; color: var(--uc-text-muted);">
            Active VMs â€” Docker Sandbox
        </h6>
    </div>

    <div class="table-responsive">
        <table class="table table-dark-override align-middle mb-0">
            <thead>
                <tr class="text-uppercase" style="font-size: 0.7rem; color: var(--uc-text-dim); border-bottom: 1px solid var(--uc-border);">
                    <th class="pb-2 ps-0" style="width: 10%;">VM ID</th>
                    <th class="pb-2" style="width: 25%;">Name</th>
                    <th class="pb-2" style="width: 20%;">Client</th>
                    <th class="pb-2" style="width: 20%;">CPU</th>
                    <th class="pb-2" style="width: 10%;">RAM</th>
                    <th class="pb-2" style="width: 10%;">Duration</th>
                    <th class="pb-2 text-end pe-0" style="width: 5%;">Revenue</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var vm in Vms)
                {
                    <tr>
                        <td class="py-3 ps-0" style="font-family: var(--uc-font-mono); color: var(--uc-text-muted); font-size: 0.8rem;">@vm.VmId</td>

                        <td class="py-3 fw-bold" style="color: var(--uc-text-white); font-size: 0.9rem;">@vm.Name</td>

                        <td class="py-3" style="color: var(--uc-text-secondary); font-size: 0.85rem;">@vm.Client</td>

                        <td class="py-3">
                            <div class="d-flex align-items-center">
                                <div class="progress me-3" style="height: 5px; width: 80px; background-color: var(--uc-border); border-radius: 2px;">
                                    <div class="progress-bar"
                                         style="width: @vm.CurrentCpuUsage%; background-color: var(--uc-blue); border-radius: 2px;">
                                    </div>
                                </div>
                                <span class="small" style="color: var(--uc-text-muted);">@vm.CurrentCpuUsage.ToString("0")%</span>
                            </div>
                        </td>

                        <td class="py-3" style="color: var(--uc-text-secondary); font-size: 0.85rem;">@vm.RamGB GB</td>

                        <td class="py-3" style="color: var(--uc-text-secondary); font-size: 0.85rem;">
                            @(vm.Uptime.Hours)h @(vm.Uptime.Minutes)m
                        </td>

                        <td class="py-3 text-end pe-0 fw-bold" style="color: var(--uc-green); font-family: var(--uc-font-mono); font-size: 0.95rem;">
                            @vm.CurrentSessionCost.ToString("C")
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@code {
    [Parameter] public List<VirtualMachine> Vms { get; set; } = new();
}